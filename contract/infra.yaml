chart_version: 0.9.0
kind: Deployment
port:
  enabled: true
  name: api
  value: 3007
  protocol: TCP

autoscaling:
  enabled: true
  maxReplicas: 3
  minReplicas: 1
  targetCPU: 85
  targetMemory: 85

resources:
  requests:
    cpu: 450m
    memory: 500Mi
  limits:
    cpu: 450m
    memory: 500Mi

image:
  registry: freelancepf{{STAGE}}registry.azurecr.io
  repository: freelance-platform-contract
  tag: '{{TAG}}'

service:
  enabled: true
  type: ClusterIP

ingress:
  enabled: false

configmaps:
  enabled: true
  shared: false

configmapdata:
  AZURE_SERVICE_BUS_SUBSCRIPTION: 'contract'
  STRIPE_SUCCESS_RETURN_PAGE: 'https://pwa.freelance-{{STAGE}}.{{DEPLOY_BASE_URL}}/betaling/bevestiging'
  STRIPE_FAILURE_RETURN_PAGE: 'https://pwa.freelance-{{STAGE}}.{{DEPLOY_BASE_URL}}/betaling/mislukt'
  STRIPE_API_VERSION: '2023-08-16'
  LOG_LEVELS: log,error,warn,debug
  DEPLOYED_ENVIRONMENT: '{{STAGE}}'

secrets:
  app: true
  shared: true

onepassword:
  enabled: true
  vault: k8s-staging

livenessProbe:
  path: /graphql?query=%7B__typename%7D
  headers:
    - name: apollo-require-preflight
      value: 'true'

readinessProbe:
  path: /graphql?query=%7B__typename%7D
  headers:
    - name: apollo-require-preflight
      value: 'true'

startupProbe:
  path: /graphql?query=%7B__typename%7D
  headers:
    - name: apollo-require-preflight
      value: 'true'
